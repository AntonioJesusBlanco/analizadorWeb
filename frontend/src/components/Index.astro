---
import Layout from '../layouts/Layout.astro';

const token = Astro.cookies.get('token')?.value || null;
---

<Layout>
  <!-- Add complete landing/documentation page -->
  <header class="border-bottom bg-white pt-5">
    <div class="container py-4">
      <div class="d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center gap-3">
          <svg width="32" height="32" fill="#0d6efd" stroke="#0d6efd" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
          </svg>
          <h1 class="h2 mb-0">URL Metrics</h1>
        </div>
        <div class="d-flex gap-2">
          {token ? (
            <>
              <a href="/dashboard" class="btn btn-primary">Dashboard</a>
              <button id="logoutBtn" class="btn btn-outline-danger">Cerrar sesión</button>
            </>
          ) : (
            <>
              <a href="/login" class="btn btn-primary">Entrar</a>
              <a href="/register" class="btn btn-outline-primary">Registrarse</a>
            </>
          )}
        </div>
      </div>
    </div>
  </header>

  <main>
    <!-- Hero Section -->
    <section class="py-5" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
      <div class="container text-center text-white">
        <h2 class="display-4 fw-bold mb-3">Analiza el Rendimiento de tus URLs</h2>
        <p class="lead mb-4">Obtén métricas detalladas, analiza archivos y optimiza el rendimiento de tus páginas web</p>
        {!token && (
          <a href="/register" class="btn btn-light btn-lg">Comenzar Ahora</a>
        )}
      </div>
    </section>

    <!-- Features Section -->
    <section class="py-5">
      <div class="container">
        <h2 class="h2 text-center mb-5 fw-bold">¿Cómo Funciona?</h2>
        <div class="row g-4">
          <div class="col-md-4">
            <div class="card h-100 shadow-sm">
              <div class="card-body text-center">
                <svg width="48" height="48" fill="#0d6efd" viewBox="0 0 24 24">
                  <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
                  <polyline points="13 2 13 9 20 9"></polyline>
                </svg>
                <h3 class="h5 mt-3 mb-2">1. Añade una URL</h3>
                <p class="text-muted small">Introduce la URL de tu página web que deseas analizar. Soportamos cualquier sitio web público.</p>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card h-100 shadow-sm">
              <div class="card-body text-center">
                <svg width="48" height="48" fill="#0d6efd" viewBox="0 0 24 24">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"></path>
                </svg>
                <h3 class="h5 mt-3 mb-2">2. Análisis Automático</h3>
                <p class="text-muted small">Nuestro sistema analiza automáticamente tu página capturando métricas, web vitals y archivos.</p>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card h-100 shadow-sm">
              <div class="card-body text-center">
                <svg width="48" height="48" fill="#0d6efd" viewBox="0 0 24 24">
                  <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"></path>
                </svg>
                <h3 class="h5 mt-3 mb-2">3. Visualiza Resultados</h3>
                <p class="text-muted small">Accede a gráficos interactivos, detalles de rendimiento y análisis de archivos capturados.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Metrics Section -->
    <section class="py-5 bg-light">
      <div class="container">
        <h2 class="h2 text-center mb-5 fw-bold">Métricas que Capturamos</h2>
        <div class="row g-3">
          <div class="col-md-6">
            <div class="d-flex gap-3 mb-3">
              <div style="flex-shrink: 0;">
                <svg width="32" height="32" fill="#28a745" viewBox="0 0 24 24">
                  <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path>
                </svg>
              </div>
              <div>
                <h4 class="h6 fw-bold mb-1">Web Vitals</h4>
                <p class="small text-muted mb-0">LCP, FID, CLS, FCP y TTFB - Las métricas principales de Google para rendimiento web</p>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="d-flex gap-3 mb-3">
              <div style="flex-shrink: 0;">
                <svg width="32" height="32" fill="#28a745" viewBox="0 0 24 24">
                  <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path>
                </svg>
              </div>
              <div>
                <h4 class="h6 fw-bold mb-1">Performance</h4>
                <p class="small text-muted mb-0">DNS, TCP, TTFB, tamaño total y tiempo real de carga detallado</p>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="d-flex gap-3 mb-3">
              <div style="flex-shrink: 0;">
                <svg width="32" height="32" fill="#28a745" viewBox="0 0 24 24">
                  <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path>
                </svg>
              </div>
              <div>
                <h4 class="h6 fw-bold mb-1">Análisis de Archivos</h4>
                <p class="small text-muted mb-0">Capturamos automáticamente JS, CSS, imágenes, fuentes y más con su tamaño y tiempo de carga</p>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="d-flex gap-3 mb-3">
              <div style="flex-shrink: 0;">
                <svg width="32" height="32" fill="#28a745" viewBox="0 0 24 24">
                  <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path>
                </svg>
              </div>
              <div>
                <h4 class="h6 fw-bold mb-1">Gráficos Interactivos</h4>
                <p class="small text-muted mb-0">Visualiza todas tus métricas en gráficos claros y comparables entre múltiples URLs</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ Section -->
    <section class="py-5">
      <div class="container">
        <h2 class="h2 text-center mb-5 fw-bold">Preguntas Frecuentes</h2>
        <div class="row g-4">
          <div class="col-lg-8 mx-auto">
            <div class="accordion" id="faqAccordion">
              <div class="accordion-item">
                <h3 class="accordion-header">
                  <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                    ¿Cuánto tiempo tarda el análisis de una URL?
                  </button>
                </h3>
                <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                  <div class="accordion-body">
                    El análisis típicamente tarda entre 15 a 30 segundos, dependiendo del tamaño y complejidad de la página. Durante este tiempo, nuestro sistema captura todas las métricas y archivos.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h3 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                    ¿Qué significa cada métrica?
                  </button>
                </h3>
                <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                  <div class="accordion-body">
                    <strong>LCP:</strong> Tiempo de carga del elemento más grande (bueno ≤2.5s)<br>
                    <strong>FID:</strong> Retraso en la primera interacción (bueno ≤100ms)<br>
                    <strong>CLS:</strong> Cambios de diseño acumulativos (bueno ≤0.1)<br>
                    <strong>FCP:</strong> Primer elemento pintado (bueno ≤1.8s)<br>
                    <strong>TTFB:</strong> Tiempo hasta el primer byte (bueno ≤800ms)
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h3 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                    ¿Puedo analizar múltiples URLs?
                  </button>
                </h3>
                <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                  <div class="accordion-body">
                    Sí, puedes añadir y analizar tantas URLs como necesites. Cada una se guardará en tu cuenta y podrás compararlas desde el dashboard.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h3 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
                    ¿Los datos se guardan?
                  </button>
                </h3>
                <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                  <div class="accordion-body">
                    Sí, todos los análisis se guardan en tu cuenta. Puedes verlos en cualquier momento en tu dashboard y comparar el rendimiento histórico.
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="py-5 bg-primary text-white">
      <div class="container text-center">
        <h2 class="h2 fw-bold mb-3">Comienza a Optimizar Hoy</h2>
        <p class="lead mb-4">Accede a herramientas profesionales de análisis de rendimiento web</p>
        {!token && (
          <a href="/register" class="btn btn-light btn-lg">Crear Cuenta Gratis</a>
        )}
        {token && (
          <a href="/dashboard" class="btn btn-light btn-lg">Ir al Dashboard</a>
        )}
      </div>
    </section>
  </main>

  <footer class="bg-dark text-white py-4 mt-5">
    <div class="container text-center">
      <p class="mb-0">© 2025 URL Metrics. Todos los derechos reservados.</p>
    </div>
  </footer>

  <script>
    const logoutBtn = document.getElementById('logoutBtn');
    if (logoutBtn) {
      logoutBtn.addEventListener('click', () => {
        document.cookie = 'token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
        localStorage.removeItem('token');
        window.location.href = '/login';
      });
    }
  </script>
</Layout>
